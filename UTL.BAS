REM UTL Class

REM === Sample Code ===
USECLASS UTL

Z=NEW(UTL)
PRINT HEX$(Z.CHRHEX("01234567"))
PRINT HEX$(Z.CHRHEX("FeDcBa98"))


END

REM === CLASS "UTL" ===
OPTION CLASSCODE

METHOD LEFT
VAR X,Y,R
X$=ARGS$(1)
Y=ARGS(2)
R$=X$(0,Y)
RETURN R$

METHOD MID
VAR X,Y,Z
X$=ARGS$(1)
Y=ARGS(2)-1
Z=ARGS(3)
R$=X$(Y,Z)
RETURN R$

METHOD RIGHT
VAR X,Y,R
X$=ARGS$(1)
Y=ARGS(2)
R$=X$(-Y)
RETURN R$

METHOD TAB
VAR Z
Z=ARGS(1)
CURSOR Z,SYSTEM(27)
RETURN

METHOD INIRND
POKE32 SYSTEM(101),CORETIMER()
RETURN

METHOD RND_
VAR I,R
I=ARGS(1)
R#=FLOAT#(RND()*I)/32767
RETURN R#

METHOD INPUTS
VAR I,R
I$=ARGS$(1)
I$=I$+"? "
PRINT I$;
R$=INPUT$()
POKE32 ARGS(2),R
RETURN

METHOD INPUTD
VAR I,R
I$=ARGS$(1)
I$=I$+"? "
PRINT I$;
R=VAL(INPUT$())
POKE32 ARGS(2),R
RETURN

METHOD INPUTF
VAR I,R
I$=ARGS$(1)
I$=I$+"? "
PRINT I$;
R#=FLOAT#(VAL(INPUT$()))
POKE32 ARGS(2),R
RETURN

METHOD STOP
WHILE INKEY()=0:WEND
END


METHOD CHRHEX
VAR A,I,R,C,D
R=0
I$=ARGS$(1)
FOR A=0 TO LEN(I$)-1
  C=ASC(I$(A,1))
  D=0
  IF ASC("0")<=C THEN
    IF ASC("9")>=C THEN
      D=C-0x30
    ENDIF
  ENDIF
  IF ASC("A")<=C THEN
    IF ASC("F")>=C THEN
      D=C+0x0A-0x41
    ENDIF
  ENDIF
  IF ASC("a")<=C THEN
    IF ASC("f")>=C THEN
      D=C+0x0A-0x61
    ENDIF
  ENDIF
  R=(R<<4)+D
NEXT
RETURN R
